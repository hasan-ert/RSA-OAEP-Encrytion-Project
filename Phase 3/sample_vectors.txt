###Register Long Term Key If you havent

{'ID': 18007, 'H': 88218584555651414149664653063252984852996369328608592806912761936758563225306, 'S': 112407997610963241520730257221736544808780485065839461576034072859092201951295, 'LKEY.X': 63655685556735212704080386336282803876000778195419948269059316555437065790774, 'LKEY.Y': 87120165909925254180750507032792816147169563483508038567634624684601215704120}
Your key is already registered.


##Check Status
You have 0 keys remained. You need to send 10 keys
You have 0 unread messages 

#####10 Ephemeral keys are registered#######
#####See Phase 2 package for details#####

### Store your ephemeral keys
### I kept them in a such a dictionary: dict[index] = [sA, ekey.x, ekey.y]
{'0': [53782636743669289290679159925021280610557754403202285573090889591675607552514, 10257154233560313427187122865996420631636099316062194091209376664083197399461, 32411081643302376423871528390146287607853529525346621052954620736837038936157], '1': [19948327365061802401648620020467063725813217641655351667204071720684734761007, 12692828852476387757013206608329472583244368236698783266607326650151234311093, 43020846085736831244172938902565539764785436040344209109671471408747878148499], '2': [88347312258361344809934366899121265066830208237203117610941345165058568829684, 46403971192527398720127314986554109722660088302311453429432141291665396991961, 39432684314676179225823752255852387436330668038089674357438647410604128655907], '3': [85232474667433991477908227366567074638149741651125636471378325557585678841144, 14161783755573530744218864874117586555442352074621114786046776678177938652612, 94896895344712016695449976869806162535367696678364267904451774997343930425614], '4': [29182554491496201272830474776672403338901277463843743330968986329611977050302, 3137452576763000766913160151857359864778752347205035378380786414845350926973, 45477027641230706294431556164008544976810419992406467807704276238722506081164], '5': [92289240135398241541536028538766592213710995103778985537125743536682572901455, 50017048916071898204648758977515075077155092748685575854838547413213592493429, 75478178367452171029739986267438159869152282748312227595542474242340865449351], '6': [30158265596607076300364814405270445335553059332268049315903689881315449562475, 17832110661345342961609511609933237578777167451634639077897153618226056711050, 72611162520242482101056142743095068725808578075369283301224276566462412751291], '7': [6492985570781223877210376820764314125582157598269813452727840814273874032700, 10068208307334585864117264603545579815897157947585774785672247684980950328388, 110606915746503691436912593003071352898812751297503333838359160550651239387878], '8': [3171758002595491839432877412863544814189085201682662525612215590058862900007, 110380780012406515888266541848210197746255368450407010255101997732815010478568, 76569350993974124049865382557025787230573462529196305870456110823242822672637], '9': [9679829234678965717132896390350657673140765250269247347546479989960574932629, 54735518330989577929696885409709650546745368741058035950034344465535078891791, 39105114651267060976393856244370917909702443706528974229058603454152035388757]}


###Request key to send a message to ID 12259
Signing '12259'... 
s:  17116765133653658742565277747650814579435936891900142944163553006548432117295 
h is:  3734840893198018442622731144976849560063776518291315263283808195030192859763
Message:  {'ID_A': 18007, 'ID_B': '12259', 'S': 17116765133653658742565277747650814579435936891900142944163553006548432117295, 'H': 3734840893198018442622731144976849560063776518291315263283808195030192859763}
12259 has no ephemeral key

#He had no ephemeral keys so I couldnt send any messages

##After he registered his ephemeral keys I tried again
###Request key to send a message to ID 12259
Signing '12259'... 
s:  17116765133653658742565277747650814579435936891900142944163553006548432117295 
h is:  3734840893198018442622731144976849560063776518291315263283808195030192859763
Message to be sent to server:  {'ID_A': 18007, 'ID_B': '12259', 'S': 17116765133653658742565277747650814579435936891900142944163553006548432117295, 'H': 3734840893198018442622731144976849560063776518291315263283808195030192859763}
{'i': '0', 'j': 0, 'QBJ.x': 97365682801917020498893546706058219881829926909589580808573293199904412091124, 'QBJ.y': 53359279815029486863148414716366623573022234263951312783306214949836151390134}


##But I forgot sending message and lost this his keys (yeah I didn't lost but pretend like I did:))
#Then I requested a new key

###Request key to send a message to ID 12259
Signing '12259'... 
s:  17116765133653658742565277747650814579435936891900142944163553006548432117295 
h is:  3734840893198018442622731144976849560063776518291315263283808195030192859763

Message to be sent to server:   {'ID_A': 18007, 'ID_B': '12259', 'S': 17116765133653658742565277747650814579435936891900142944163553006548432117295, 'H': 3734840893198018442622731144976849560063776518291315263283808195030192859763}
Response of the server: {'i': '0', 'j': 3, 'QBJ.x': 9277392309895145675771158110185582766170392309763715838934424498504315877128, 'QBJ.y': 91659176112270828781046010485454375119314639335640489640832646781269364889006}
This is my message: You can dance, you can jive
ctext: b't\xdb5\xd1\x88\x08mD\xf1\xe6\xcf`\x00\x86\xc7F\x16\x1d\x17\x15\xfa\x82r\xe0\xf0S\x06'
nonce+ctext+hmac: b"\xe9ojr\xa4\xba\x9agt\xdb5\xd1\x88\x08mD\xf1\xe6\xcf`\x00\x86\xc7F\x16\x1d\x17\x15\xfa\x82r\xe0\xf0S\x06o\x96\x18ht\xb1(z\x81\xfd\xa1\x90\x13c\xc0\x17\x9fz\x82\x17\xde\xcd\xaeo\xab\xa1\xc6'R a]"

int of the ctext: 205118148917878976617423442593894948932323743224057410721091765960816947665049553684612108769262624854493512348083809525375927870530179801269203540035337313083741
Message to be sent to server: {'ID_A': 18007, 'ID_B': '12259', 'I': '0', 'J': 3, 'MSG': 205118148917878976617423442593894948932323743224057410721091765960816947665049553684612108769262624854493512348083809525375927870530179801269203540035337313083741}
Server's response: Message saved

#Get my messages
Signing stuID to retrive my messages...
Send this to server:{'ID_A': 18007, 'S': 112407997610963241520730257221736544808780485065839461576034072859092201951295, 'H': 88218584555651414149664653063252984852996369328608592806912761936758563225306}

Response of the server: {'IDB': 12259, 'KEYID': 0, 'MSG': 23405781793547589761069090013431891940652817580491777841612094226505019770744151760737336117566709699012891688194468599467272671534453800156469913695200657959651264, 'QBJ.X': 73016788913147631159736313868414760693730597760025887930042422330281190065950, 'QBJ.Y': 44925819890827699088259045682823391728447157210399229870559309271640659260494}

#Decrypting cipher messages

KEYID:  0 
sA for this message:  53782636743669289290679159925021280610557754403202285573090889591675607552514
msg:  b"h\r\x02\x0c\xf6\xc8\xd8\xa3\x86<GF\xb7\xf1\xebi\x0ek\xcb\x89\xff\xea+FX\xfd;\x14\xee~'8{SC\x1e#\x082\xf43\xd5\xaa]\x18K\xf6\xbfb\x10\x02\xc1oE\x99OV\x00\x9b]\xdado\xfb\xdc\x11\x87\xc0"
T:  (0x4cc1613b6700f3843d80f58aa1cfd822110b0bdf16b956b23ffaf05e44a48970 , 0x974d81c7ac2a89a60b23f2a454271f68848c0ebef09b56c3bdf02fd17c29446c)
U:  3471744904671052309644898336454024787637702177847077568063681188704052448702468436183068500496141083582982163155617464421231190063162738473952946051171436NoNeedToRunAndHide
U_encode:  b'3471744904671052309644898336454024787637702177847077568063681188704052448702468436183068500496141083582982163155617464421231190063162738473952946051171436NoNeedToRunAndHide'
Kenc:  b'\xfc\x92un\xb6U\x0b\x05i\xa0\xe3\xb3\xbc\xa2\xca\xb78}M\x05\xb1w\xf6"u0\x1c=@\xd5\xc9\x01'
Kmac:  b'g\x0e|\x0e \xba\xd9\xe1\xf6+\xf0%\xc0\xc92/Y\xb7\x86\xe9~\x85\xe4\xfb\x8c{8p\x8e\x00\xe0\xbb'
message: b"h\r\x02\x0c\xf6\xc8\xd8\xa3\x86<GF\xb7\xf1\xebi\x0ek\xcb\x89\xff\xea+FX\xfd;\x14\xee~'8{SC\x1e#\x082\xf43\xd5\xaa]\x18K\xf6\xbfb\x10\x02\xc1oE\x99OV\x00\x9b]\xdado\xfb\xdc\x11\x87\xc0" 
ciphertext: b"\x86<GF\xb7\xf1\xebi\x0ek\xcb\x89\xff\xea+FX\xfd;\x14\xee~'8{SC\x1e" 
hmac: b'#\x082\xf43\xd5\xaa]\x18K\xf6\xbfb\x10\x02\xc1oE\x99OV\x00\x9b]\xdado\xfb\xdc\x11\x87\xc0'
The message is authentic
decrypted message:  Having the time of your life

